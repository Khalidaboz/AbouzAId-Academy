<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Math Wizard Academy üßô‚Äç‚ôÇÔ∏è</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #ff6b6b 0%, #feca57 25%, #48dbfb 50%, #ff9ff3 75%, #54a0ff 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0;
            margin: 0;
            position: relative;
            overflow-x: hidden;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        body::before {
            content: '‚≠ê‚ú®üåüüí´üéØüöÄü¶Ñüé™üîÆü™Ñüåàüé®üéâüéÅüéàüç≠üç¨üå∫ü¶ãüêù';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            font-size: 3em;
            opacity: 0.15;
            animation: float 20s infinite linear;
            pointer-events: none;
            word-spacing: 100px;
            line-height: 150px;
        }

        @keyframes float {
            0% { transform: translate(0, 0) rotate(0deg); }
            100% { transform: translate(50px, 50px) rotate(360deg); }
        }

        .container {
            background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.98) 100%);
            backdrop-filter: blur(10px);
            border-radius: 0;
            padding: 40px 60px;
            max-width: 100%;
            width: 100%;
            height: 100vh;
            box-shadow: none;
            overflow-y: auto;
        }

        h1 {
            text-align: center;
            background: linear-gradient(45deg, #ff6b6b, #feca57, #48dbfb, #ff9ff3, #54a0ff, #00d2d3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 40px;
            font-size: 4em;
            animation: rainbow 3s ease infinite;
            background-size: 200% 200%;
        }

        @keyframes rainbow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .mode-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            justify-content: center;
        }

        .mode-btn {
            padding: 20px 50px;
            border: none;
            border-radius: 15px;
            font-size: 1.5em;
            cursor: pointer;
            transition: all 0.3s;
            background: #f0f0f0;
            color: #333;
            font-weight: 600;
        }

        .mode-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .mode-btn.active {
            background: linear-gradient(135deg, #ff6b6b 0%, #feca57 50%, #48dbfb 100%);
            color: white;
            box-shadow: 0 5px 20px rgba(255, 107, 107, 0.5);
        }

        .content-area {
            min-height: calc(100vh - 300px);
        }

        /* Learn Mode */
        .table-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        .table-btn {
            padding: 25px;
            border: 3px solid transparent;
            background: linear-gradient(white, white) padding-box,
                        linear-gradient(45deg, #ff6b6b, #feca57, #48dbfb) border-box;
            border-radius: 12px;
            color: #333;
            font-size: 1.5em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .table-btn:hover {
            background: linear-gradient(135deg, #feca57, #48dbfb);
            color: white;
            transform: scale(1.1) rotate(5deg);
        }

        .table-btn.selected {
            background: linear-gradient(135deg, #ff6b6b, #feca57);
            color: white;
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.5);
        }

        .multiplication-table {
            background: linear-gradient(135deg, #fff5f5 0%, #fffbea 50%, #f0f9ff 100%);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border: 3px solid transparent;
            background-clip: padding-box;
            box-shadow: 0 5px 20px rgba(255, 107, 107, 0.2);
        }

        .table-row {
            padding: 10px;
            margin: 5px 0;
            background: white;
            border-radius: 5px;
            font-size: 1.2em;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 5px solid #ff6b6b;
            transition: all 0.3s;
        }

        .table-row:nth-child(even) {
            border-left-color: #feca57;
        }

        .table-row:nth-child(3n) {
            border-left-color: #48dbfb;
        }

        .table-row:hover {
            transform: translateX(10px);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        /* Practice Mode */
        .practice-area {
            text-align: center;
        }

        .question {
            font-size: 5em;
            background: linear-gradient(45deg, #ff6b6b, #feca57, #48dbfb, #ff9ff3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            background-size: 200% 200%;
            animation: questionGlow 2s ease infinite;
            margin: 60px 0;
            font-weight: 600;
        }

        @keyframes questionGlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .answer-input {
            font-size: 3em;
            padding: 20px 35px;
            border: 5px solid transparent;
            background: linear-gradient(white, white) padding-box,
                        linear-gradient(45deg, #ff6b6b, #feca57, #48dbfb, #ff9ff3) border-box;
            border-radius: 15px;
            text-align: center;
            width: 300px;
            margin: 30px 0;
            animation: borderPulse 2s ease infinite;
        }

        @keyframes borderPulse {
            0%, 100% { background: linear-gradient(white, white) padding-box,
                                    linear-gradient(45deg, #ff6b6b, #feca57, #48dbfb, #ff9ff3) border-box; }
            50% { background: linear-gradient(white, white) padding-box,
                              linear-gradient(45deg, #48dbfb, #ff9ff3, #ff6b6b, #feca57) border-box; }
        }

        .answer-input:focus {
            outline: none;
            box-shadow: 0 0 30px rgba(255, 107, 107, 0.5);
        }

        .submit-btn {
            padding: 20px 60px;
            font-size: 1.5em;
            background: linear-gradient(135deg, #ff6b6b 0%, #feca57 50%, #48dbfb 100%);
            background-size: 200% 200%;
            animation: buttonShimmer 3s ease infinite;
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-weight: 600;
            margin: 15px;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }

        @keyframes buttonShimmer {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .submit-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 25px rgba(255, 107, 107, 0.6);
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .feedback {
            font-size: 2em;
            margin: 30px 0;
            padding: 25px;
            border-radius: 15px;
            font-weight: 600;
        }

        .feedback.correct {
            background: linear-gradient(135deg, #55efc4 0%, #00b894 100%);
            color: white;
            box-shadow: 0 5px 20px rgba(0, 184, 148, 0.4);
            animation: bounce 0.5s ease;
        }

        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .feedback.incorrect {
            background: linear-gradient(135deg, #fdcb6e 0%, #e17055 100%);
            color: white;
            box-shadow: 0 5px 20px rgba(253, 203, 110, 0.4);
            animation: shake 0.5s ease;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            padding: 20px;
            background: linear-gradient(135deg, #fff5f5 0%, #fffbea 50%, #f0f9ff 100%);
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 3em;
            font-weight: 700;
            background: linear-gradient(45deg, #ff6b6b, #feca57, #48dbfb);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            color: #666;
            margin-top: 10px;
            font-size: 1.2em;
        }

        /* Test Mode */
        .test-setup {
            text-align: center;
        }

        .setup-option {
            margin: 20px 0;
        }

        .setup-option label {
            font-size: 1.2em;
            color: #333;
            margin-right: 15px;
        }

        .setup-option input[type="number"] {
            font-size: 1.1em;
            padding: 10px;
            border: 2px solid #667eea;
            border-radius: 5px;
            width: 100px;
        }

        .progress-bar {
            background: #e9ecef;
            border-radius: 10px;
            height: 30px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #ff6b6b 0%, #feca57 33%, #48dbfb 66%, #ff9ff3 100%);
            height: 100%;
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.5);
        }

        .test-results {
            text-align: center;
            padding: 20px;
        }

        .score-display {
            font-size: 6em;
            background: linear-gradient(45deg, #ff6b6b, #feca57, #48dbfb, #ff9ff3);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            background-size: 200% 200%;
            animation: scoreShine 2s ease infinite;
            font-weight: 700;
            margin: 40px 0;
        }

        @keyframes scoreShine {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .grade {
            font-size: 2.5em;
            margin: 30px 0;
            padding: 30px;
            border-radius: 20px;
            font-weight: 600;
        }

        .grade.excellent {
            background: linear-gradient(135deg, #55efc4 0%, #00b894 100%);
            color: white;
            box-shadow: 0 10px 30px rgba(0, 184, 148, 0.5);
            animation: celebrate 1s ease infinite;
        }

        @keyframes celebrate {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .grade.good {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
            box-shadow: 0 10px 30px rgba(9, 132, 227, 0.5);
        }

        .grade.needs-practice {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            color: #2d3436;
            box-shadow: 0 10px 30px rgba(253, 203, 110, 0.5);
        }

        .hidden {
            display: none;
        }

        .table-range {
            display: flex;
            gap: 10px;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
            cursor: pointer;
        }

        .checkbox-label input {
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üßô‚Äç‚ôÇÔ∏è Math Wizard Academy ‚ú®</h1>
        
        <div class="mode-selector">
            <button class="mode-btn active" data-mode="learn">üîÆ Spell Book</button>
            <button class="mode-btn" data-mode="practice">‚öîÔ∏è Training Ground</button>
            <button class="mode-btn" data-mode="test">üèÜ Boss Battle</button>
        </div>

        <div class="content-area">
            <!-- Learn Mode -->
            <div id="learn-mode">
                <h2 style="text-align: center; margin-bottom: 20px; color: #333;">Pick your magic spell to master! ü™Ñ</h2>
                <div class="table-selector">
                    <button class="table-btn" data-table="1">1</button>
                    <button class="table-btn" data-table="2">2</button>
                    <button class="table-btn" data-table="3">3</button>
                    <button class="table-btn" data-table="4">4</button>
                    <button class="table-btn" data-table="5">5</button>
                    <button class="table-btn" data-table="6">6</button>
                    <button class="table-btn" data-table="7">7</button>
                    <button class="table-btn" data-table="8">8</button>
                    <button class="table-btn" data-table="9">9</button>
                    <button class="table-btn" data-table="10">10</button>
                    <button class="table-btn" data-table="11">11</button>
                    <button class="table-btn" data-table="12">12</button>
                </div>
                <div id="table-display" class="multiplication-table hidden"></div>
            </div>

            <!-- Practice Mode -->
            <div id="practice-mode" class="hidden">
                <div class="practice-area">
                    <h2 style="margin-bottom: 20px; color: #333;">Time to Level Up Your Powers! ‚ö°</h2>
                    
                    <div class="table-range">
                        <label>Choose your spells:</label>
                        <input type="number" id="practice-min" min="1" max="12" value="1">
                        <span>to</span>
                        <input type="number" id="practice-max" min="1" max="12" value="10">
                        <button class="submit-btn" onclick="startPractice()">Start</button>
                    </div>

                    <div id="practice-content" class="hidden">
                        <div class="stats">
                            <div class="stat-item">
                                <div class="stat-number" id="correct-count">0</div>
                                <div class="stat-label">‚≠ê Victories</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="incorrect-count">0</div>
                                <div class="stat-label">üí• Oopsies</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" id="streak-count">0</div>
                                <div class="stat-label">üî• Epic Streak</div>
                            </div>
                        </div>

                        <div class="question" id="practice-question">5 √ó 7 = ?</div>
                        <input type="number" class="answer-input" id="practice-answer" placeholder="?">
                        <br>
                        <button class="submit-btn" onclick="checkPracticeAnswer()">Cast Spell! ü™Ñ</button>
                        <button class="submit-btn" onclick="nextPracticeQuestion()">Too Hard! üòÖ</button>
                        <div id="practice-feedback" class="feedback hidden"></div>
                    </div>
                </div>
            </div>

            <!-- Test Mode -->
            <div id="test-mode" class="hidden">
                <div id="test-setup" class="test-setup">
                    <h2 style="margin-bottom: 20px; color: #333;">Ready to Battle the Math Dragon? üêâ</h2>
                    
                    <div class="setup-option">
                        <label>How many enemies to fight:</label>
                        <input type="number" id="num-questions" min="5" max="50" value="10">
                    </div>

                    <div class="setup-option">
                        <label>Choose your weapons (spell numbers):</label>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" class="table-checkbox" value="1" checked> 1
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" class="table-checkbox" value="2" checked> 2
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" class="table-checkbox" value="3" checked> 3
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" class="table-checkbox" value="4" checked> 4
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" class="table-checkbox" value="5" checked> 5
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" class="table-checkbox" value="6" checked> 6
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" class="table-checkbox" value="7" checked> 7
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" class="table-checkbox" value="8" checked> 8
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" class="table-checkbox" value="9" checked> 9
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" class="table-checkbox" value="10" checked> 10
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" class="table-checkbox" value="11"> 11
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" class="table-checkbox" value="12"> 12
                            </label>
                        </div>
                    </div>

                    <button class="submit-btn" onclick="startTest()">FIGHT THE DRAGON! üêâ‚öîÔ∏è</button>
                </div>

                <div id="test-content" class="hidden">
                    <div class="progress-bar">
                        <div class="progress-fill" id="test-progress">0/10</div>
                    </div>

                    <div class="practice-area">
                        <div class="question" id="test-question">5 √ó 7 = ?</div>
                        <input type="number" class="answer-input" id="test-answer" placeholder="?">
                        <br>
                        <button class="submit-btn" onclick="submitTestAnswer()">ATTACK! ‚öîÔ∏è</button>
                    </div>
                </div>

                <div id="test-results" class="test-results hidden">
                    <h2>üéä BATTLE COMPLETE! üéä</h2>
                    <div class="score-display" id="final-score">0%</div>
                    <div id="grade-message" class="grade"></div>
                    <button class="submit-btn" onclick="resetTest()">Battle Again! üó°Ô∏è</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // State management
        let currentMode = 'learn';
        let practiceStats = { correct: 0, incorrect: 0, streak: 0 };
        let currentQuestion = null;
        let practiceRange = { min: 1, max: 10 };
        let testData = {
            questions: [],
            currentIndex: 0,
            answers: [],
            totalQuestions: 10
        };

        // Mode switching
        document.querySelectorAll('.mode-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                const mode = btn.dataset.mode;
                currentMode = mode;
                
                document.getElementById('learn-mode').classList.add('hidden');
                document.getElementById('practice-mode').classList.add('hidden');
                document.getElementById('test-mode').classList.add('hidden');
                
                document.getElementById(`${mode}-mode`).classList.remove('hidden');
            });
        });

        // Learn Mode
        document.querySelectorAll('.table-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.table-btn').forEach(b => b.classList.remove('selected'));
                btn.classList.add('selected');
                
                const table = parseInt(btn.dataset.table);
                displayTable(table);
            });
        });

        function displayTable(table) {
            const display = document.getElementById('table-display');
            display.classList.remove('hidden');
            display.innerHTML = `<h3 style="text-align: center; margin-bottom: 15px; background: linear-gradient(45deg, #ff6b6b, #feca57, #48dbfb); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">üîÆ The Magical Spell of ${table} üîÆ</h3>`;
            
            for (let i = 1; i <= 12; i++) {
                const row = document.createElement('div');
                row.className = 'table-row';
                row.innerHTML = `
                    <span>${table} √ó ${i}</span>
                    <span style="font-weight: 700; color: #667eea;">${table * i}</span>
                `;
                display.appendChild(row);
            }
        }

        // Practice Mode
        function startPractice() {
            const min = parseInt(document.getElementById('practice-min').value);
            const max = parseInt(document.getElementById('practice-max').value);
            
            if (min > max) {
                alert('Oops! Your starting spell can\'t be bigger than your ending spell! ü§™');
                return;
            }
            
            practiceRange = { min, max };
            practiceStats = { correct: 0, incorrect: 0, streak: 0 };
            updatePracticeStats();
            
            document.getElementById('practice-content').classList.remove('hidden');
            nextPracticeQuestion();
        }

        function nextPracticeQuestion() {
            const num1 = Math.floor(Math.random() * (practiceRange.max - practiceRange.min + 1)) + practiceRange.min;
            const num2 = Math.floor(Math.random() * 12) + 1;
            
            currentQuestion = { num1, num2, answer: num1 * num2 };
            
            document.getElementById('practice-question').textContent = `${num1} √ó ${num2} = ?`;
            document.getElementById('practice-answer').value = '';
            document.getElementById('practice-feedback').classList.add('hidden');
            document.getElementById('practice-answer').focus();
        }

        function checkPracticeAnswer() {
            const userAnswer = parseInt(document.getElementById('practice-answer').value);
            const feedback = document.getElementById('practice-feedback');
            
            if (isNaN(userAnswer)) {
                alert('Hey! You need to type a number, silly! üòú');
                return;
            }
            
            feedback.classList.remove('hidden');
            
            if (userAnswer === currentQuestion.answer) {
                const funnyMessages = [
                    '‚ú® BOOM! You\'re a math wizard! ‚ú®',
                    'üéØ BULLSEYE! That\'s correct!',
                    'üöÄ WHOOSH! You nailed it!',
                    'ü¶∏ SUPERHERO MOVE! Amazing!',
                    'üé™ WOW! You\'re on fire!',
                    'üåü SPECTACULAR! Keep it up!',
                    'üé® MAGNIFICENT! You\'re crushing it!',
                    'ü¶Ñ MAGICAL! That\'s right!',
                    'üé∏ ROCKSTAR! You got it!'
                ];
                const randomMessage = funnyMessages[Math.floor(Math.random() * funnyMessages.length)];
                feedback.textContent = randomMessage;
                feedback.className = 'feedback correct';
                practiceStats.correct++;
                practiceStats.streak++;
                
                // Add confetti effect!
                createConfetti();
            } else {
                const funnyMessages = [
                    `Oopsie-daisy! The magic number is ${currentQuestion.answer} üéà`,
                    `Nice try! It's actually ${currentQuestion.answer} üåà`,
                    `So close! The answer is ${currentQuestion.answer} üéØ`,
                    `Whoopsie! It's ${currentQuestion.answer} - you'll get the next one! üí™`,
                    `Not quite, champ! It's ${currentQuestion.answer} üé™`,
                    `Almost! The secret code is ${currentQuestion.answer} üîê`,
                    `Good effort! The answer is ${currentQuestion.answer} üåü`
                ];
                const randomMessage = funnyMessages[Math.floor(Math.random() * funnyMessages.length)];
                feedback.textContent = randomMessage;
                feedback.className = 'feedback incorrect';
                practiceStats.incorrect++;
                practiceStats.streak = 0;
            }
            
            updatePracticeStats();
            
            setTimeout(() => {
                nextPracticeQuestion();
            }, 1500);
        }

        function updatePracticeStats() {
            document.getElementById('correct-count').textContent = practiceStats.correct;
            document.getElementById('incorrect-count').textContent = practiceStats.incorrect;
            document.getElementById('streak-count').textContent = practiceStats.streak;
        }

        // Test Mode
        function startTest() {
            const numQuestions = parseInt(document.getElementById('num-questions').value);
            const selectedTables = Array.from(document.querySelectorAll('.table-checkbox:checked')).map(cb => parseInt(cb.value));
            
            if (selectedTables.length === 0) {
                alert('Whoops! You need to pick at least one spell to battle with! ü™Ñ');
                return;
            }
            
            // Generate test questions
            testData.questions = [];
            for (let i = 0; i < numQuestions; i++) {
                const table = selectedTables[Math.floor(Math.random() * selectedTables.length)];
                const multiplier = Math.floor(Math.random() * 12) + 1;
                testData.questions.push({
                    num1: table,
                    num2: multiplier,
                    answer: table * multiplier
                });
            }
            
            testData.currentIndex = 0;
            testData.answers = [];
            testData.totalQuestions = numQuestions;
            
            document.getElementById('test-setup').classList.add('hidden');
            document.getElementById('test-content').classList.remove('hidden');
            
            showTestQuestion();
        }

        function showTestQuestion() {
            const question = testData.questions[testData.currentIndex];
            document.getElementById('test-question').textContent = `${question.num1} √ó ${question.num2} = ?`;
            document.getElementById('test-answer').value = '';
            document.getElementById('test-answer').focus();
            
            updateTestProgress();
        }

        function updateTestProgress() {
            const progress = ((testData.currentIndex) / testData.totalQuestions) * 100;
            const progressFill = document.getElementById('test-progress');
            progressFill.style.width = progress + '%';
            progressFill.textContent = `${testData.currentIndex}/${testData.totalQuestions}`;
        }

        function submitTestAnswer() {
            const userAnswer = parseInt(document.getElementById('test-answer').value);
            
            if (isNaN(userAnswer)) {
                alert('Don\'t forget to type your answer, brave warrior! üó°Ô∏è');
                return;
            }
            
            const question = testData.questions[testData.currentIndex];
            testData.answers.push({
                correct: userAnswer === question.answer,
                userAnswer,
                correctAnswer: question.answer
            });
            
            testData.currentIndex++;
            
            if (testData.currentIndex < testData.totalQuestions) {
                showTestQuestion();
            } else {
                showTestResults();
            }
        }

        function showTestResults() {
            document.getElementById('test-content').classList.add('hidden');
            document.getElementById('test-results').classList.remove('hidden');
            
            const correctAnswers = testData.answers.filter(a => a.correct).length;
            const percentage = Math.round((correctAnswers / testData.totalQuestions) * 100);
            
            document.getElementById('final-score').textContent = `${percentage}%`;
            
            const gradeMessage = document.getElementById('grade-message');
            
            if (percentage >= 90) {
                gradeMessage.className = 'grade excellent';
                gradeMessage.textContent = `üèÜ LEGENDARY! You defeated ${correctAnswers} out of ${testData.totalQuestions} enemies! You're a MASTER WIZARD! üßô‚Äç‚ôÇÔ∏è‚ú®`;
            } else if (percentage >= 70) {
                gradeMessage.className = 'grade good';
                gradeMessage.textContent = `üéñÔ∏è GREAT JOB! You beat ${correctAnswers} out of ${testData.totalQuestions} enemies! You're becoming really powerful! üí™‚ö°`;
            } else {
                gradeMessage.className = 'grade needs-practice';
                gradeMessage.textContent = `üå± NICE TRY! You got ${correctAnswers} out of ${testData.totalQuestions}! Every wizard starts somewhere - keep training! üéØüîÆ`;
            }
        }

        function resetTest() {
            document.getElementById('test-results').classList.add('hidden');
            document.getElementById('test-setup').classList.remove('hidden');
        }

        // Enter key support
        document.getElementById('practice-answer').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') checkPracticeAnswer();
        });

        document.getElementById('test-answer').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') submitTestAnswer();
        });

        // Initialize with first table displayed
        displayTable(1);
        document.querySelector('.table-btn[data-table="1"]').classList.add('selected');

        // Confetti function for celebrations!
        function createConfetti() {
            const colors = ['#ff6b6b', '#feca57', '#48dbfb', '#ff9ff3', '#54a0ff', '#55efc4'];
            const confettiCount = 30;
            
            for (let i = 0; i < confettiCount; i++) {
                const confetti = document.createElement('div');
                confetti.style.position = 'fixed';
                confetti.style.width = '10px';
                confetti.style.height = '10px';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.top = '-10px';
                confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                confetti.style.opacity = '1';
                confetti.style.pointerEvents = 'none';
                confetti.style.zIndex = '9999';
                
                document.body.appendChild(confetti);
                
                const fall = confetti.animate([
                    { 
                        transform: `translateY(0) rotate(0deg)`,
                        opacity: 1
                    },
                    { 
                        transform: `translateY(${window.innerHeight + 20}px) rotate(${Math.random() * 360}deg)`,
                        opacity: 0
                    }
                ], {
                    duration: Math.random() * 2000 + 1000,
                    easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'
                });
                
                fall.onfinish = () => confetti.remove();
            }
        }
    </script>
</body>
</html>
